<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DFT-FE: dftfe/include/cg_descent_wrapper.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DFT-FE
   &#160;<span id="projectnumber">0.6.0</span>
   </div>
   <div id="projectbrief">Density Functional Theory With Finite-Elements</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a3bde88210fa5bc126f7f8b106d1bb69.html">dftfe</a></li><li class="navelem"><a class="el" href="dir_56b2361891e28d860a31db3431d8e631.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cg_descent_wrapper.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cg__descent__wrapper_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _CGD_WRAPPER_H__</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _CGD_WRAPPER_H__</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dft_utils_8h.html">dftUtils.h</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nonlinear_solver_problem_8h.html">nonlinearSolverProblem.h</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cg__user_8h.html">cg_user.h</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/* entries in cg_descent</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * cg_descent (x, n, NULL, NULL, grad_tol, user_value, user_gradient, user_value_gradient, NULL) ;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * where n is x.size(), grad_tol is a float</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * must have signature</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  double pycgd_value(double *x, INT n);</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  void pycgd_gradient(double *g, double *x, INT n);</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * Performance is often improved if the user also provides a routine to</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * simultaneously evaluate the objective function and its gradient</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *  double pycgd_value_gradient(double *g, double *x, INT n);</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *  NOTE:   this version relies on the pele library</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classdftfe_1_1nonlinear_solver_problem.html">dftfe::nonlinearSolverProblem</a>* functionToBeMinimized;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">size_t</span> glob_nfev;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> cgd_value(<span class="keywordtype">double</span>* x, <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> n)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">//compute the increment in the solution vector</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  std::vector&lt;double&gt; xPrev,solutionInc;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a57432a0cd4697e3af47a04923c481ef9">solution</a>(xPrev);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  solutionInc.resize(xPrev.size());</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; xPrev.size(); ++i)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    solutionInc[i] = *(x+i) - xPrev[i];</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  MPI_Bcast(&amp;solutionInc[0],</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        solutionInc.size(),</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        MPI_DOUBLE,</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        0,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        MPI_COMM_WORLD);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a18cb9c702387c0fc0bea19dc358e331c">update</a>(solutionInc);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::vector&lt;double&gt; funcValue;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a3448d983593e8e98ee594e4285f1f465">value</a>(funcValue);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#aef5a7d70f38f60fc254553b3cf42c12d">save</a>();</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  ++glob_nfev;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">return</span> funcValue[0];</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">//AssertThrow(false,dftfe::dftUtils::ExcNotImplementedYet());</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> cgd_gradient(<span class="keywordtype">double</span>* g, <span class="keywordtype">double</span>* x, <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> n)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">//pele::Array&lt;double&gt; xarray(x, (size_t) n);</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//pele::Array&lt;double&gt; garray(g, (size_t) n);</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//glob_pot-&gt;get_energy_gradient(xarray, garray);</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//compute the increment in the solution vector</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  std::vector&lt;double&gt; xPrev,solutionInc;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a57432a0cd4697e3af47a04923c481ef9">solution</a>(xPrev);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  solutionInc.resize(xPrev.size());</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; xPrev.size(); ++i)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    solutionInc[i] = *(x+i) - xPrev[i];</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  MPI_Bcast(&amp;solutionInc[0],</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        solutionInc.size(),</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        MPI_DOUBLE,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        0,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        MPI_COMM_WORLD);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a18cb9c702387c0fc0bea19dc358e331c">update</a>(solutionInc);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#aef5a7d70f38f60fc254553b3cf42c12d">save</a>();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  std::vector&lt;double&gt; gradient;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#ab4406839bedb92f39ac663738c699bf1">gradient</a>(gradient);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; xPrev.size(); ++i)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    *(g+i) = gradient[i];</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ++glob_nfev;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">//AssertThrow(false,dftfe::dftUtils::ExcNotImplementedYet());</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> cgd_value_gradient(<span class="keywordtype">double</span>* g, <span class="keywordtype">double</span>* x, <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> n)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">//pele::Array&lt;double&gt; xarray(x, (size_t) n);</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">//pele::Array&lt;double&gt; garray(g, (size_t) n);</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  ++glob_nfev;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//return glob_pot-&gt;get_energy_gradient(xarray, garray);</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">//compute the increment in the solution vector</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  std::vector&lt;double&gt; xPrev,solutionInc;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a57432a0cd4697e3af47a04923c481ef9">solution</a>(xPrev);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  solutionInc.resize(xPrev.size());</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; xPrev.size(); ++i)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    solutionInc[i] = *(x+i) - xPrev[i];</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  MPI_Bcast(&amp;solutionInc[0],</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        solutionInc.size(),</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        MPI_DOUBLE,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        0,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        MPI_COMM_WORLD);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a18cb9c702387c0fc0bea19dc358e331c">update</a>(solutionInc);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#aef5a7d70f38f60fc254553b3cf42c12d">save</a>();  </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  std::vector&lt;double&gt; funcValue;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a3448d983593e8e98ee594e4285f1f465">value</a>(funcValue);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  std::vector&lt;double&gt; gradient;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  functionToBeMinimized-&gt;<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#ab4406839bedb92f39ac663738c699bf1">gradient</a>(gradient);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; xPrev.size(); ++i)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    *(g+i) = gradient[i];</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">return</span> funcValue[0];</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> cgd_test_callback(<span class="keywordtype">double</span> f, <span class="keywordtype">double</span>* x, <span class="keywordtype">double</span>* g, <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> n, <span class="keywordtype">void</span>* user_data);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;} <span class="comment">// namespace</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacedftfe.html">dftfe</a> {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html">  145</a></span>&#160;<span class="keyword">class </span><a class="code" href="classdftfe_1_1_c_g_descent.html">CGDescent</a> {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a93f05127b85f8e34f1f912bea71a0995">  147</a></span>&#160;  <a class="code" href="structcg__parameter__struct.html">cg_parameter</a> <a class="code" href="classdftfe_1_1_c_g_descent.html#a93f05127b85f8e34f1f912bea71a0995">m_parm</a>;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a73063b665d64e975a021dda376c1db4c">  148</a></span>&#160;  <a class="code" href="structcg__stats__struct.html">cg_stats</a> <a class="code" href="classdftfe_1_1_c_g_descent.html#a73063b665d64e975a021dda376c1db4c">m_stats</a>;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#adcd74c94ed3426d91467162cbea4c451">  149</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="classdftfe_1_1_c_g_descent.html#adcd74c94ed3426d91467162cbea4c451">m_x0</a>, <a class="code" href="classdftfe_1_1_c_g_descent.html#a9ee73a979c67ce711ec58007281c3cd6">m_x</a>;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a8aef441d8b41a3bf882da0ec12743e15">  150</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a8aef441d8b41a3bf882da0ec12743e15">m_tol</a>;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af91efb8b8a735e9ea6ac95fd6d5f40e9">  151</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af91efb8b8a735e9ea6ac95fd6d5f40e9">m_nfev</a>;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ae4467fd6ed85237f28a5ad5487082eda">  152</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ae4467fd6ed85237f28a5ad5487082eda">m_success</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a5acd5e05bb73f6521432988304c49f8a">  154</a></span>&#160;  <a class="code" href="classdftfe_1_1_c_g_descent.html#a5acd5e05bb73f6521432988304c49f8a">CGDescent</a>(<span class="keywordtype">double</span> tol, <span class="keywordtype">size_t</span> maxIter,  <span class="keywordtype">size_t</span> PrintLevel=0)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        : m_parm(),</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          m_stats(),</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          m_tol(tol),</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          m_nfev(0),</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          m_success(false)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">/*set default parameter values*/</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="cg__user_8h.html#a42b666fbc79514b576dd461dcf739b7d">cg_default</a>(&amp;m_parm);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a7d4f355c4a362d60a9f478759fbd111b">PrintFinal</a> = <a class="code" href="cg__user_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a21479dee2c00bd065ce0832259cba8d3">AWolfeFac</a> = 0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a750538df9c26252a900231f0609d39af">AWolfe</a> = <a class="code" href="cg__user_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#ac15d2ee94365a3ff9a35460c3f67fdf0">memory</a> = 0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a044434b3876deef5d615e641d1909ac8">maxit</a> = maxIter;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a526228bf019667e4b0380d899479dbb3">PrintLevel</a> = PrintLevel;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        m_parm.<a class="code" href="structcg__parameter__struct.html#a68f188545179fa6dd85151bca9c8f57e">psi2</a> = 10.0;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#aa4fa7356ac4c740ed85a6ee6553f9c2b">  173</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#aa4fa7356ac4c740ed85a6ee6553f9c2b">~CGDescent</a>() {}</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a05ccf3f395311cb63d47400f13a921d2">  175</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a05ccf3f395311cb63d47400f13a921d2">test_convergence</a>(<span class="keywordtype">double</span> energy, std::vector&lt;double&gt; x, std::vector&lt;double&gt; g) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">//run</span></div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ab7b35ef5d14a46d8b02445f59ce46b8b">  178</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ab7b35ef5d14a46d8b02445f59ce46b8b">run</a>(<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html">nonlinearSolverProblem</a> &amp; problem)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        functionToBeMinimized = &amp;problem;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        glob_nfev = 0; <span class="comment">//reset global variable</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        m_nfev = 0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        m_success = <span class="keyword">false</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//Get initial values of x</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    problem.<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#a57432a0cd4697e3af47a04923c481ef9">solution</a>(m_x);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    std::vector&lt;double&gt; gradient;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    problem.<a class="code" href="classdftfe_1_1nonlinear_solver_problem.html#ab4406839bedb92f39ac663738c699bf1">gradient</a>(gradient);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">//using ::cg_descent call in the global namespace (the one in CG_DESCENT 6.8), this resolves the ambiguity</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> cgout = <a class="code" href="cg__user_8h.html#abdbed41ac61843cd8b97d75281847a07">::cg_descent</a>(&amp;m_x[0], m_x.size(), &amp;<a class="code" href="classdftfe_1_1_c_g_descent.html#a73063b665d64e975a021dda376c1db4c">m_stats</a>, &amp;<a class="code" href="classdftfe_1_1_c_g_descent.html#a93f05127b85f8e34f1f912bea71a0995">m_parm</a>, <a class="code" href="classdftfe_1_1_c_g_descent.html#a8aef441d8b41a3bf882da0ec12743e15">m_tol</a>, cgd_value,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                cgd_gradient, cgd_value_gradient, <a class="code" href="cg__user_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, cgd_test_callback, (<span class="keywordtype">void</span>*) <span class="keyword">this</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        m_success = this-&gt;<a class="code" href="classdftfe_1_1_c_g_descent.html#a0a6f6bc41c9ad2d96f584e0bf64002dd">test_success</a>(cgout);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        m_nfev = glob_nfev;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ae4467fd6ed85237f28a5ad5487082eda">m_success</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">/*inline void run(size_t maxiter)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    {</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">        this-&gt;set_maxit(maxiter);</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">        this-&gt;run();</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">    }*/</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a19cefaf50c35ccf2e0c17a5f275ed7dd">  207</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a19cefaf50c35ccf2e0c17a5f275ed7dd">reset</a>(std::vector&lt;double&gt; &amp;x)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        this-&gt;<a class="code" href="classdftfe_1_1_c_g_descent.html#a35c52ed1d04bec1be6b219483d674a22">set_x</a>(x);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        m_nfev = 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        m_success = <span class="keyword">false</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/*============================================================================</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">      CG_DESCENT6.8 parameters that the user may wish to modify</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">     ----------------------------------------------------------------------------*/</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">/* Level 0 = no printing, ... , Level 3 = maximum printing */</span></div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ac614d8c29bf570ec91c00dd5f5a4747f">  218</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ac614d8c29bf570ec91c00dd5f5a4747f">set_PrintLevel</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a526228bf019667e4b0380d899479dbb3">PrintLevel</a> = val; }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">/* abort cg after maxit iterations */</span></div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af29faebdbd8409c6ecbba5bfff6305b9">  220</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af29faebdbd8409c6ecbba5bfff6305b9">set_maxit</a>(<span class="keywordtype">size_t</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a044434b3876deef5d615e641d1909ac8">maxit</a> = (<a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a>) val; }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">/* number of vectors stored in memory */</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a953aa6c122d319feacd9ce4bd346c42c">  222</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a953aa6c122d319feacd9ce4bd346c42c">set_memory</a>(<span class="keywordtype">int</span> memory) { m_parm.<a class="code" href="structcg__parameter__struct.html#ac15d2ee94365a3ff9a35460c3f67fdf0">memory</a> = memory; }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/* T =&gt; use approximate Wolfe line search</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">       F =&gt; use ordinary Wolfe line search, switch to approximate Wolfe when</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">           |f_k+1-f_k| &lt; AWolfeFac*C_k, C_k = average size of cost  */</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a13015a6586542e0e424438ef5b69e850">  226</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a13015a6586542e0e424438ef5b69e850">set_AWolfeFac</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a21479dee2c00bd065ce0832259cba8d3">AWolfeFac</a> = val; }</div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a4478c53b55c69840418d37d2a84a3fdb">  227</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a4478c53b55c69840418d37d2a84a3fdb">set_AWolfe</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a750538df9c26252a900231f0609d39af">AWolfe</a> = (int) val; }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* T =&gt; use LBFGS</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">       F =&gt; only use L-BFGS when memory &gt;= n */</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af4655bd4ea36e58fc5bc97ca812af9d9">  230</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af4655bd4ea36e58fc5bc97ca812af9d9">set_lbfgs</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a15b1b5dbda522d04ff3413bbe783ae52">LBFGS</a> = (int) val; }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">/* T =&gt; attempt quadratic interpolation in line search when</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">       |f_k+1 - f_k|/f_k &lt;= QuadCutoff</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">       F =&gt; no quadratic interpolation step */</span></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#afcabd054dcd10c43af69f1cd93e4667d">  234</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#afcabd054dcd10c43af69f1cd93e4667d">set_QuadStep</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#afe4684e1ebf95658e177d505a35bc245">QuadStep</a> = (int) val; }</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af09e97d49b1189f7e83d7ce944ca96ae">  235</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af09e97d49b1189f7e83d7ce944ca96ae">set_QuadCutOff</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#af561684af9bedf42854b6e03fcd35085">QuadCutOff</a> = val; }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">/* maximum factor by which a quad step can reduce the step size */</span></div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a728e0044e2a4e11ebd61f02150937238">  237</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a728e0044e2a4e11ebd61f02150937238">set_QuadSafe</a>(<span class="keywordtype">double</span> val){ m_parm.<a class="code" href="structcg__parameter__struct.html#a72fcf3b930cf489f4fed336198a9a708">QuadSafe</a> = val; }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/* T =&gt; when possible, use a cubic step in the line search */</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a90a0efa350f2ee9ae6cc31df078b5290">  239</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a90a0efa350f2ee9ae6cc31df078b5290">set_UseCubic</a>(<span class="keywordtype">bool</span> val){ m_parm.<a class="code" href="structcg__parameter__struct.html#a6fb70ca7ce5c6c2f7ee884f85650d75f">UseCubic</a> = (int) val; }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">/* use cubic step when |f_k+1 - f_k|/|f_k| &gt; CubicCutOff */</span></div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a5b6e0c3ed98b43ec25dd832738eb0a21">  241</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a5b6e0c3ed98b43ec25dd832738eb0a21">set_CubicCutOff</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a40d3a8afe8c4f5d3429417119de20731">CubicCutOff</a> = val; }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* |f| &lt; SmallCost*starting cost =&gt; skip QuadStep and set PertRule = FALSE*/</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ad804798a24ec86b7ad552fe234edf7d7">  243</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ad804798a24ec86b7ad552fe234edf7d7">set_SmallCost</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a3bc3b427ee3108e684e7b3acc5868ca1">SmallCost</a> = val; }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">/* if step is nonzero, it is the initial step of the initial line search */</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#adc32f706c486b1b53dc2213e623ea05a">  245</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#adc32f706c486b1b53dc2213e623ea05a">set_step</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a883c6324ee0b2004884782570cc8dcfa">step</a> = val; }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* terminate after nslow iterations without strict improvement in</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">       either function value or gradient */</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ac6bedeb975d221e555f25860498b1277">  248</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ac6bedeb975d221e555f25860498b1277">set_nslow</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ac9ac81ce0bba3418c95fae8776cc3722">nslow</a> = val; }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">/* Stop Rules:</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">       T =&gt; ||proj_grad||_infty &lt;= max(grad_tol,initial ||grad||_infty*StopFact)</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">       F =&gt; ||proj_grad||_infty &lt;= grad_tol*(1 + |f_k|) */</span></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a7de73016a906231fe38bdfb4db28619b">  252</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a7de73016a906231fe38bdfb4db28619b">set_StopRule</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a87da47146aa50dd92da19901970c29ad">StopRule</a> = (int) val; }</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a824ae209629e470c11f45eca5ded3630">  253</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a824ae209629e470c11f45eca5ded3630">set_StopFac</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a7dfba9a311a2ecf1f225187a15be7f32">StopFac</a> = val; }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a35c52ed1d04bec1be6b219483d674a22">  255</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a35c52ed1d04bec1be6b219483d674a22">set_x</a>(std::vector&lt;double&gt; &amp; x)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      m_x = x;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      m_x0 = <a class="code" href="classdftfe_1_1_c_g_descent.html#a9ee73a979c67ce711ec58007281c3cd6">m_x</a>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* SubCheck and SubSkip control the frequency with which the subspace</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">       condition is checked. It is checked for SubCheck*mem iterations and</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">       if not satisfied, then it is skipped for Subskip*mem iterations</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">       and Subskip is doubled. Whenever the subspace condition is statisfied,</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">       SubSkip is returned to its original value. */</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ab3975ce666eb2f1eb7a3d495c4faca2a">  265</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ab3975ce666eb2f1eb7a3d495c4faca2a">set_SubCheck</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a11d8a579dd756137545c7f46458a4957">SubCheck</a> = val; }</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a5cca82761a6f656b40674469dc31d1bc">  266</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a5cca82761a6f656b40674469dc31d1bc">set_SubSkip</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#aad21b1ae6585de5e83e54281c8b1a1b6">SubSkip</a> = val; }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">/* when relative distance from current gradient to subspace &lt;= eta0,</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">       enter subspace if subspace dimension = mem */</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#aebfe50b05a79757c935ee2db0cf81b9e">  269</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#aebfe50b05a79757c935ee2db0cf81b9e">set_eta0</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#abde2e610201c933502183d07843ddc16">eta0</a> = val; }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">/* when relative distance from current gradient to subspace &gt;= eta1,</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">       leave subspace */</span></div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ac25e69d3e6bb90c3cbaf49e960786c04">  272</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ac25e69d3e6bb90c3cbaf49e960786c04">set_eta1</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a2c3108a46c4d15521ecc4649e835fc45">eta1</a> = val; }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">/* when relative distance from current direction to subspace &lt;= eta2,</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">       always enter subspace (invariant space) */</span></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a51661f00f4e95907f13916e983ee034c">  275</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a51661f00f4e95907f13916e983ee034c">set_eta2</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a1e7f99cfafc0aca0e8d609ac8401547c">eta2</a> = val; }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">/* factor in [0, 1] used to compute average cost magnitude C_k as follows:</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">       Q_k = 1 + (Qdecay)Q_k-1, Q_0 = 0,  C_k = C_k-1 + (|f_k| - C_k-1)/Q_k */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a24f31e8bc19e53ccb860874ef5007520">  278</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a24f31e8bc19e53ccb860874ef5007520">set_Qdecay</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#aafe37373c7a6eb1961852845a6f54906">Qdecay</a> = val; }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">/* T =&gt; estimated error in function value is eps*Ck,</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">       F =&gt; estimated error in function value is eps */</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a55ea0e4b4ecf73571d92700ce03dbac8">  281</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a55ea0e4b4ecf73571d92700ce03dbac8">set_PertRule</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ab173409cf2e2011a1b6cfc179a147e03">PertRule</a> = (int)val; }</div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ac040a760211531184adb34dbb3819c1e">  282</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ac040a760211531184adb34dbb3819c1e">set_eps</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a754b6587ac1011fbe0175a7f6fb5a038">eps</a> = val; }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">/* factor by which eps grows when line search fails during contraction */</span></div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#aa00962dc65c94974ace1c1c183bf6845">  284</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#aa00962dc65c94974ace1c1c183bf6845">set_egrow</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a491e84600534c377c6eb65b2428928a7">egrow</a> = val; }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">/* T =&gt; check that f_k+1 - f_k &lt;= debugtol*C_k</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">       F =&gt; no checking of function values */</span></div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a4b01dd0060c23e88e65ff9f947d94815">  287</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a4b01dd0060c23e88e65ff9f947d94815">set_debug</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#acae87a01a285078c7ee7b0454c1b7fa3">debug</a> = (int)val; }</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a625589a5b63d48fcf0ff588d9513a20d">  288</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a625589a5b63d48fcf0ff588d9513a20d">set_debugtol</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a6c0c50a9b3e25b0029fd77eaf46e48f7">debugtol</a> = val; }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">/* maximum number of times the bracketing interval grows during expansion */</span></div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a8ac17353878af771829e7eb1c6354ec7">  290</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a8ac17353878af771829e7eb1c6354ec7">set_ntries</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#abe04c47ad784eb18f56d25b8b51469ee">ntries</a> = val; }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* maximum factor secant step increases stepsize in expansion phase */</span></div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a75e1bd8507008d8e75a50aa6fff68a41">  292</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a75e1bd8507008d8e75a50aa6fff68a41">set_ExpandSafe</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a60f7b89a452f93b1f2f6879d9b321cee">ExpandSafe</a> = val; }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">/* factor by which secant step is amplified during expansion phase</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">       where minimizer is bracketed */</span></div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a9bec5b0a6ccedabb00dd50d713c08db5">  295</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a9bec5b0a6ccedabb00dd50d713c08db5">set_SecantAmp</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#acd20f528c0b975211de66034dd193be0">SecantAmp</a> = val; }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">/* factor by which rho grows during expansion phase where minimizer is</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">       bracketed */</span></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ad0d1f9a25cde2abcf0578e4951eb2ca9">  298</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ad0d1f9a25cde2abcf0578e4951eb2ca9">set_RhoGrow</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a2dce061b51654acbc4ff64822575e551">RhoGrow</a> = val; }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">/* maximum number of times that eps is updated */</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a1edc1987e841eab5a212770d865428de">  300</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a1edc1987e841eab5a212770d865428de">set_neps</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ab338c70505cb708603d217724ad34cd1">neps</a> = val; }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">/* maximum number of times the bracketing interval shrinks */</span></div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#aad4a7a9085d45ba0546a16314374d5c1">  302</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#aad4a7a9085d45ba0546a16314374d5c1">set_nshrink</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a5461fe48774acaf55df955fe43397b10">nshrink</a> = val; }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">/* maximum number of iterations in line search */</span></div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a1c01d68d9cc7ba89ec13106335c4dbd5">  304</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a1c01d68d9cc7ba89ec13106335c4dbd5">set_nline</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#afc6f0a24db08ab66aa1c0cde1f86759f">nline</a> = val; }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">/* conjugate gradient method restarts after (n*restart_fac) iterations */</span></div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a7f897a3e4021337d3b88eee4408d1852">  306</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a7f897a3e4021337d3b88eee4408d1852">set_restart_fac</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#abe4a6b4501da5b5ca8e8e9b7fd8a61dd">restart_fac</a> = val; }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/* stop when -alpha*dphi0 (estimated change in function value) &lt;= feps*|f|*/</span></div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a121a2ee034bf8075100753c300c7a7e8">  308</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a121a2ee034bf8075100753c300c7a7e8">set_feps</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a786f6873bf8943ac388d02250779e0dc">feps</a> = val; }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">/* after encountering nan, growth factor when searching for</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">       a bracketing interval */</span></div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a1b2d69cf05f8a5a57bbbc008ac6ad6d6">  311</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a1b2d69cf05f8a5a57bbbc008ac6ad6d6">set_nan_rho</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ac848eae777ea4459e06b0e9ec22f7cdc">nan_rho</a> = val; }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">/* after encountering nan, decay factor for stepsize */</span></div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a9b16464d7416931f59c4415cd25a9dfc">  313</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a9b16464d7416931f59c4415cd25a9dfc">set_nan_decay</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ab6006e51c959d0382dade71e0d1e442b">nan_decay</a> = val; }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">/*============================================================================</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">       CG_DESCENT6.8 technical parameters which the user probably should not touch</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">  ----------------------------------------------------------------------------*/</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">/* Wolfe line search parameter */</span></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ab0104144badd489e913520d07edac60f">  319</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ab0104144badd489e913520d07edac60f">set_delta</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a2be434ff4799abac4034ab50e3fbda44">delta</a> = val; }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">/* Wolfe line search parameter */</span></div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a26bf4250315c3ba5b375f12073a8c025">  321</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a26bf4250315c3ba5b375f12073a8c025">set_sigma</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a4d949ee342bbb7775c1a3e0dc3165362">sigma</a> = val; }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">/* decay factor for bracket interval width */</span></div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a1041dc3618f13f5ebf0dc2a91736973f">  323</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a1041dc3618f13f5ebf0dc2a91736973f">set_gamma</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#abacd072d5fd0cd63a823b0d74e427ed5">gamma</a> = val; }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">/* growth factor when searching for initial bracketing interval */</span></div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a3b8a7649dd0015d0b8113b3b5d00ecfa">  325</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a3b8a7649dd0015d0b8113b3b5d00ecfa">set_rho</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a22eb421516094b5e223eee24bffd76ae">rho</a> = val; }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">/* factor used in starting guess for iteration 1 */</span></div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af73324d32def745baa324532149fc534">  327</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af73324d32def745baa324532149fc534">set_psi0</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ade7756f592e179c9a69350218dfbf073">psi0</a> = val; }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/* in performing a QuadStep, we evaluate at point betweeen</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    [psi_lo, psi_hi]*psi2*previous step */</span></div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#afa368c3b4403260e3a89f2d72f6b3677">  330</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#afa368c3b4403260e3a89f2d72f6b3677">set_psi_lo</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#abdf3050689c148c71152d9843c05c57d">psi_lo</a> = val; }</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a05ec6a0d0c7db6bf51f570220cc4ecd1">  331</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a05ec6a0d0c7db6bf51f570220cc4ecd1">set_psi_hi</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a04559d5374ee519928cac52e4541cf17">psi_hi</a> = val; }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">/* for approximate quadratic, use gradient at psi1*psi2*previous step</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">    for initial stepsize */</span></div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a16ff87801c05817984c7bc962f2dfb8c">  334</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a16ff87801c05817984c7bc962f2dfb8c">set_psi1</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a6b4dbcbd829363ab4604057ef67ecf4e">psi1</a> = val; }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">/* when starting a new cg iteration, our initial guess for the line search</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">    stepsize is psi2*previous step */</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#abde94af74691575fc3f1f0d92f61382a">  337</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#abde94af74691575fc3f1f0d92f61382a">set_psi2</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a68f188545179fa6dd85151bca9c8f57e">psi2</a> = val; }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/* T =&gt; choose beta adaptively, F =&gt; use theta */</span></div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a3ca0c3574a54cfbb6e778598c1dfb00e">  339</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a3ca0c3574a54cfbb6e778598c1dfb00e">set_AdaptiveBeta</a>(<span class="keywordtype">bool</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a03ccc792fc2db609d6398862e5804702">AdaptiveBeta</a> = (int)val; }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">/* lower bound factor for beta */</span></div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a8247b79cacf861b1c4b99112c6522072">  341</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a8247b79cacf861b1c4b99112c6522072">set_BetaLower</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#adea3529cfefa3d398b4b70506cefc5ff">BetaLower</a> = val; }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">/* parameter describing the cg_descent family */</span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a0ad0648daeac70bba385a580b05e86ec">  343</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a0ad0648daeac70bba385a580b05e86ec">set_theta</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#ad7e00ca78fcb4929bf51a33d6950b7e5">theta</a> = val; }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">/* parameter in cost error for quadratic restart criterion */</span></div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a41b9ecc8b2fcfc08e6e665b9f8f5e260">  345</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a41b9ecc8b2fcfc08e6e665b9f8f5e260">set_qeps</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#aae96d10c9eeaa49f1a6e1c5caab16038">qeps</a> = val; }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">/* parameter used to decide if cost is quadratic */</span></div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#af03050fb7309da012fe353c840800b9f">  347</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af03050fb7309da012fe353c840800b9f">set_qrule</a>(<span class="keywordtype">double</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a81c14101191e0ccfd5533aa866472014">qrule</a> = val; }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">/* number of iterations the function should be nearly quadratic before</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">    a restart */</span></div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#aa8483749be0880731cc39f2df6286de8">  350</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#aa8483749be0880731cc39f2df6286de8">set_qrestart</a>(<span class="keywordtype">int</span> val) { m_parm.<a class="code" href="structcg__parameter__struct.html#a3fb940cd33373e61dce212967a4ea22d">qrestart</a> = val; }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">/*============================================================================</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">      results returned that can be retrieved by the user</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  ----------------------------------------------------------------------------*/</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">/*function value at solution */</span></div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#acf9b3ca01ce9838807c4768abceb0601">  357</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#acf9b3ca01ce9838807c4768abceb0601">get_f</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a0d970c122c452bd139801dca960e7fb0">f</a>; }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">/* max abs component of gradient */</span></div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a6accabee69ba898359fe6d71743562e3">  359</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a6accabee69ba898359fe6d71743562e3">get_gnorm</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a27e17338fa5c415beba5f2d3e35a87a9">gnorm</a>; }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">/* number of iterations */</span></div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ab30c2653e8ff433d961c9e2b0f6cee37">  361</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ab30c2653e8ff433d961c9e2b0f6cee37">get_iter</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a5f9255d9b5972d8a5b7733f92e71b141">iter</a>; }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">/* number of subspace iterations */</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a28d35557ecd2989bcd460b3380074e78">  363</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a28d35557ecd2989bcd460b3380074e78">get_IterSub</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a2b65a997649c8825769c40bdb591f13e">IterSub</a>; }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">/* total number subspaces */</span></div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ac904961bb4c64006c901d586ad1d8936">  365</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ac904961bb4c64006c901d586ad1d8936">get_NumSub</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a2a3894018c5aa384605d1384f4ec0ba1">NumSub</a>; }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">/* number of function evaluations */</span></div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#ab90a24ead034aaddf8e60033a34682c7">  367</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ab90a24ead034aaddf8e60033a34682c7">get_nfunc</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#a46a535c2ac90380fee2d8e81d3e5024e">nfunc</a>; }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">/* number of gradient evaluations */</span></div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a194e3a2f02c4f8f6919faa5b4c027a44">  369</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a194e3a2f02c4f8f6919faa5b4c027a44">get_ngrad</a>() { <span class="keywordflow">return</span> m_stats.<a class="code" href="structcg__stats__struct.html#aef9497b92840dd2ba17e3ed8cbb6e58c">ngrad</a>; }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">/* total number of function evaluations from global counter*/</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#abfe9a0672ac0104d22691ceefb400706">  371</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#abfe9a0672ac0104d22691ceefb400706">get_nfev</a>() { <span class="keywordflow">return</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#af91efb8b8a735e9ea6ac95fd6d5f40e9">m_nfev</a>; }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/*return success status*/</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a0ab2d94b26946d649dc883c0f79671ea">  373</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a0ab2d94b26946d649dc883c0f79671ea">success</a>() { <span class="keywordflow">return</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#ae4467fd6ed85237f28a5ad5487082eda">m_success</a>; }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">/*return modified coordinates*/</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">//inline pele::Array&lt;double&gt; get_x() { return m_x.copy(); }</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">/*return gradient*/</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//inline pele::Array&lt;double&gt; get_g()</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">//{</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">//  pele::Array&lt;double&gt; g(m_x.size());</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">//    m_pot-&gt;get_energy_gradient(m_x, g);</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">//    return g.copy();</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">/*get root mean square gradient*/</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//inline double get_rms()</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//{</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">//  pele::Array&lt;double&gt; g = this-&gt;get_g();</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//    return norm(g) / sqrt(m_x.size());</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a5e343430b14155edcbcc3b4139f14a9c">  389</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a5e343430b14155edcbcc3b4139f14a9c">set_tol</a>(<span class="keywordtype">double</span> val) { m_tol = val; }</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a75dbc4f3c43174d72cc8070c6af230e7">  390</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a75dbc4f3c43174d72cc8070c6af230e7">get_tol</a>() { <span class="keywordflow">return</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a8aef441d8b41a3bf882da0ec12743e15">m_tol</a>; }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="classdftfe_1_1_c_g_descent.html#a0a6f6bc41c9ad2d96f584e0bf64002dd">  393</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classdftfe_1_1_c_g_descent.html#a0a6f6bc41c9ad2d96f584e0bf64002dd">test_success</a>(<a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> cgout)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">if</span> (cgout == 0) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">switch</span> (cgout) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">case</span> -2:</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;function value became nan&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">case</span> -1:</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;starting function value is nan&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;change in func &lt;= feps*|f|&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;total iterations exceeded maxit&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;slope always negative in line search&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;number secant iterations exceed nsecant&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;search direction not a descent direction&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;line search fails in initial interval&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;line search fails during bisection&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;line search fails during interval update&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;debugger is on and the function value increases&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;out of memory&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;function nan or +-INF and could not be repaired&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;invalid choice for memory parameter&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;failed, value not known&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;};</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;} <span class="comment">// namespace pycgd</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> cgd_test_callback(<span class="keywordtype">double</span> f, <span class="keywordtype">double</span>* x, <span class="keywordtype">double</span>* g, <a class="code" href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a> n, <span class="keywordtype">void</span>* user_data)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classdftfe_1_1_c_g_descent.html">dftfe::CGDescent</a> * cgd = <span class="keyword">static_cast&lt;</span><a class="code" href="classdftfe_1_1_c_g_descent.html">dftfe::CGDescent</a>*<span class="keyword">&gt;</span>(user_data);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    std::vector&lt;double&gt; xarray;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    std::vector&lt;double&gt; garray;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) cgd-&gt;<a class="code" href="classdftfe_1_1_c_g_descent.html#a05ccf3f395311cb63d47400f13a921d2">test_convergence</a>(f, xarray, garray);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;} <span class="comment">// namespace</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#endif // #ifndef _CGD_WRAPPER_H__</span></div><div class="ttc" id="classdftfe_1_1_c_g_descent_html_a3ca0c3574a54cfbb6e778598c1dfb00e"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a3ca0c3574a54cfbb6e778598c1dfb00e">dftfe::CGDescent::set_AdaptiveBeta</a></div><div class="ttdeci">void set_AdaptiveBeta(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:339</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a9ee73a979c67ce711ec58007281c3cd6"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a9ee73a979c67ce711ec58007281c3cd6">dftfe::CGDescent::m_x</a></div><div class="ttdeci">std::vector&lt; double &gt; m_x</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:149</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a6c0c50a9b3e25b0029fd77eaf46e48f7"><div class="ttname"><a href="structcg__parameter__struct.html#a6c0c50a9b3e25b0029fd77eaf46e48f7">cg_parameter_struct::debugtol</a></div><div class="ttdeci">double debugtol</div><div class="ttdef"><b>Definition:</b> cg_user.h:121</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a73063b665d64e975a021dda376c1db4c"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a73063b665d64e975a021dda376c1db4c">dftfe::CGDescent::m_stats</a></div><div class="ttdeci">cg_stats m_stats</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:148</div></div>
<div class="ttc" id="structcg__parameter__struct_html_abe04c47ad784eb18f56d25b8b51469ee"><div class="ttname"><a href="structcg__parameter__struct.html#abe04c47ad784eb18f56d25b8b51469ee">cg_parameter_struct::ntries</a></div><div class="ttdeci">int ntries</div><div class="ttdef"><b>Definition:</b> cg_user.h:130</div></div>
<div class="ttc" id="structcg__parameter__struct_html_aafe37373c7a6eb1961852845a6f54906"><div class="ttname"><a href="structcg__parameter__struct.html#aafe37373c7a6eb1961852845a6f54906">cg_parameter_struct::Qdecay</a></div><div class="ttdeci">double Qdecay</div><div class="ttdef"><b>Definition:</b> cg_user.h:80</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a1c01d68d9cc7ba89ec13106335c4dbd5"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a1c01d68d9cc7ba89ec13106335c4dbd5">dftfe::CGDescent::set_nline</a></div><div class="ttdeci">void set_nline(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:304</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a90a0efa350f2ee9ae6cc31df078b5290"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a90a0efa350f2ee9ae6cc31df078b5290">dftfe::CGDescent::set_UseCubic</a></div><div class="ttdeci">void set_UseCubic(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:239</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af73324d32def745baa324532149fc534"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af73324d32def745baa324532149fc534">dftfe::CGDescent::set_psi0</a></div><div class="ttdeci">void set_psi0(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:327</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a625589a5b63d48fcf0ff588d9513a20d"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a625589a5b63d48fcf0ff588d9513a20d">dftfe::CGDescent::set_debugtol</a></div><div class="ttdeci">void set_debugtol(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:288</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_afa368c3b4403260e3a89f2d72f6b3677"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#afa368c3b4403260e3a89f2d72f6b3677">dftfe::CGDescent::set_psi_lo</a></div><div class="ttdeci">void set_psi_lo(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:330</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a75dbc4f3c43174d72cc8070c6af230e7"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a75dbc4f3c43174d72cc8070c6af230e7">dftfe::CGDescent::get_tol</a></div><div class="ttdeci">double get_tol()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:390</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a4478c53b55c69840418d37d2a84a3fdb"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a4478c53b55c69840418d37d2a84a3fdb">dftfe::CGDescent::set_AWolfe</a></div><div class="ttdeci">void set_AWolfe(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:227</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ab0104144badd489e913520d07edac60f"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ab0104144badd489e913520d07edac60f">dftfe::CGDescent::set_delta</a></div><div class="ttdeci">void set_delta(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:319</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html">dftfe::nonlinearSolverProblem</a></div><div class="ttdoc">Abstract class for solver functions. </div><div class="ttdef"><b>Definition:</b> nonlinearSolverProblem.h:27</div></div>
<div class="ttc" id="structcg__parameter__struct_html_acae87a01a285078c7ee7b0454c1b7fa3"><div class="ttname"><a href="structcg__parameter__struct.html#acae87a01a285078c7ee7b0454c1b7fa3">cg_parameter_struct::debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition:</b> cg_user.h:120</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ac25e69d3e6bb90c3cbaf49e960786c04"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ac25e69d3e6bb90c3cbaf49e960786c04">dftfe::CGDescent::set_eta1</a></div><div class="ttdeci">void set_eta1(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:272</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a0a6f6bc41c9ad2d96f584e0bf64002dd"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a0a6f6bc41c9ad2d96f584e0bf64002dd">dftfe::CGDescent::test_success</a></div><div class="ttdeci">bool test_success(INT cgout)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:393</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a35c52ed1d04bec1be6b219483d674a22"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a35c52ed1d04bec1be6b219483d674a22">dftfe::CGDescent::set_x</a></div><div class="ttdeci">void set_x(std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:255</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ac6bedeb975d221e555f25860498b1277"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ac6bedeb975d221e555f25860498b1277">dftfe::CGDescent::set_nslow</a></div><div class="ttdeci">void set_nslow(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:248</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_adcd74c94ed3426d91467162cbea4c451"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#adcd74c94ed3426d91467162cbea4c451">dftfe::CGDescent::m_x0</a></div><div class="ttdeci">std::vector&lt; double &gt; m_x0</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:149</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a05ec6a0d0c7db6bf51f570220cc4ecd1"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a05ec6a0d0c7db6bf51f570220cc4ecd1">dftfe::CGDescent::set_psi_hi</a></div><div class="ttdeci">void set_psi_hi(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:331</div></div>
<div class="ttc" id="structcg__stats__struct_html"><div class="ttname"><a href="structcg__stats__struct.html">cg_stats_struct</a></div><div class="ttdef"><b>Definition:</b> cg_user.h:192</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a22eb421516094b5e223eee24bffd76ae"><div class="ttname"><a href="structcg__parameter__struct.html#a22eb421516094b5e223eee24bffd76ae">cg_parameter_struct::rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> cg_user.h:171</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a81c14101191e0ccfd5533aa866472014"><div class="ttname"><a href="structcg__parameter__struct.html#a81c14101191e0ccfd5533aa866472014">cg_parameter_struct::qrule</a></div><div class="ttdeci">double qrule</div><div class="ttdef"><b>Definition:</b> cg_user.h:187</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_afcabd054dcd10c43af69f1cd93e4667d"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#afcabd054dcd10c43af69f1cd93e4667d">dftfe::CGDescent::set_QuadStep</a></div><div class="ttdeci">void set_QuadStep(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:234</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a0ab2d94b26946d649dc883c0f79671ea"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a0ab2d94b26946d649dc883c0f79671ea">dftfe::CGDescent::success</a></div><div class="ttdeci">bool success()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:373</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ac15d2ee94365a3ff9a35460c3f67fdf0"><div class="ttname"><a href="structcg__parameter__struct.html#ac15d2ee94365a3ff9a35460c3f67fdf0">cg_parameter_struct::memory</a></div><div class="ttdeci">int memory</div><div class="ttdef"><b>Definition:</b> cg_user.h:50</div></div>
<div class="ttc" id="structcg__stats__struct_html_a2a3894018c5aa384605d1384f4ec0ba1"><div class="ttname"><a href="structcg__stats__struct.html#a2a3894018c5aa384605d1384f4ec0ba1">cg_stats_struct::NumSub</a></div><div class="ttdeci">INT NumSub</div><div class="ttdef"><b>Definition:</b> cg_user.h:198</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a5b6e0c3ed98b43ec25dd832738eb0a21"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a5b6e0c3ed98b43ec25dd832738eb0a21">dftfe::CGDescent::set_CubicCutOff</a></div><div class="ttdeci">void set_CubicCutOff(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:241</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a05ccf3f395311cb63d47400f13a921d2"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a05ccf3f395311cb63d47400f13a921d2">dftfe::CGDescent::test_convergence</a></div><div class="ttdeci">virtual bool test_convergence(double energy, std::vector&lt; double &gt; x, std::vector&lt; double &gt; g)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:175</div></div>
<div class="ttc" id="structcg__parameter__struct_html_aad21b1ae6585de5e83e54281c8b1a1b6"><div class="ttname"><a href="structcg__parameter__struct.html#aad21b1ae6585de5e83e54281c8b1a1b6">cg_parameter_struct::SubSkip</a></div><div class="ttdeci">int SubSkip</div><div class="ttdef"><b>Definition:</b> cg_user.h:58</div></div>
<div class="ttc" id="cg__user_8h_html_a42b666fbc79514b576dd461dcf739b7d"><div class="ttname"><a href="cg__user_8h.html#a42b666fbc79514b576dd461dcf739b7d">cg_default</a></div><div class="ttdeci">void cg_default(cg_parameter *Parm)</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_acf9b3ca01ce9838807c4768abceb0601"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#acf9b3ca01ce9838807c4768abceb0601">dftfe::CGDescent::get_f</a></div><div class="ttdeci">double get_f()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:357</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a8aef441d8b41a3bf882da0ec12743e15"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a8aef441d8b41a3bf882da0ec12743e15">dftfe::CGDescent::m_tol</a></div><div class="ttdeci">double m_tol</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:150</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a491e84600534c377c6eb65b2428928a7"><div class="ttname"><a href="structcg__parameter__struct.html#a491e84600534c377c6eb65b2428928a7">cg_parameter_struct::egrow</a></div><div class="ttdeci">double egrow</div><div class="ttdef"><b>Definition:</b> cg_user.h:98</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ade7756f592e179c9a69350218dfbf073"><div class="ttname"><a href="structcg__parameter__struct.html#ade7756f592e179c9a69350218dfbf073">cg_parameter_struct::psi0</a></div><div class="ttdeci">double psi0</div><div class="ttdef"><b>Definition:</b> cg_user.h:173</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a2be434ff4799abac4034ab50e3fbda44"><div class="ttname"><a href="structcg__parameter__struct.html#a2be434ff4799abac4034ab50e3fbda44">cg_parameter_struct::delta</a></div><div class="ttdeci">double delta</div><div class="ttdef"><b>Definition:</b> cg_user.h:168</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a824ae209629e470c11f45eca5ded3630"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a824ae209629e470c11f45eca5ded3630">dftfe::CGDescent::set_StopFac</a></div><div class="ttdeci">void set_StopFac(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:253</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a526228bf019667e4b0380d899479dbb3"><div class="ttname"><a href="structcg__parameter__struct.html#a526228bf019667e4b0380d899479dbb3">cg_parameter_struct::PrintLevel</a></div><div class="ttdeci">int PrintLevel</div><div class="ttdef"><b>Definition:</b> cg_user.h:39</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a194e3a2f02c4f8f6919faa5b4c027a44"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a194e3a2f02c4f8f6919faa5b4c027a44">dftfe::CGDescent::get_ngrad</a></div><div class="ttdeci">size_t get_ngrad()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:369</div></div>
<div class="ttc" id="structcg__parameter__struct_html_afe4684e1ebf95658e177d505a35bc245"><div class="ttname"><a href="structcg__parameter__struct.html#afe4684e1ebf95658e177d505a35bc245">cg_parameter_struct::QuadStep</a></div><div class="ttdeci">int QuadStep</div><div class="ttdef"><b>Definition:</b> cg_user.h:103</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a6fb70ca7ce5c6c2f7ee884f85650d75f"><div class="ttname"><a href="structcg__parameter__struct.html#a6fb70ca7ce5c6c2f7ee884f85650d75f">cg_parameter_struct::UseCubic</a></div><div class="ttdeci">int UseCubic</div><div class="ttdef"><b>Definition:</b> cg_user.h:110</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a8ac17353878af771829e7eb1c6354ec7"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a8ac17353878af771829e7eb1c6354ec7">dftfe::CGDescent::set_ntries</a></div><div class="ttdeci">void set_ntries(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:290</div></div>
<div class="ttc" id="structcg__stats__struct_html_a0d970c122c452bd139801dca960e7fb0"><div class="ttname"><a href="structcg__stats__struct.html#a0d970c122c452bd139801dca960e7fb0">cg_stats_struct::f</a></div><div class="ttdeci">double f</div><div class="ttdef"><b>Definition:</b> cg_user.h:194</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a5acd5e05bb73f6521432988304c49f8a"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a5acd5e05bb73f6521432988304c49f8a">dftfe::CGDescent::CGDescent</a></div><div class="ttdeci">CGDescent(double tol, size_t maxIter, size_t PrintLevel=0)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:154</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a72fcf3b930cf489f4fed336198a9a708"><div class="ttname"><a href="structcg__parameter__struct.html#a72fcf3b930cf489f4fed336198a9a708">cg_parameter_struct::QuadSafe</a></div><div class="ttdeci">double QuadSafe</div><div class="ttdef"><b>Definition:</b> cg_user.h:107</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_abde94af74691575fc3f1f0d92f61382a"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#abde94af74691575fc3f1f0d92f61382a">dftfe::CGDescent::set_psi2</a></div><div class="ttdeci">void set_psi2(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:337</div></div>
<div class="ttc" id="structcg__parameter__struct_html_acd20f528c0b975211de66034dd193be0"><div class="ttname"><a href="structcg__parameter__struct.html#acd20f528c0b975211de66034dd193be0">cg_parameter_struct::SecantAmp</a></div><div class="ttdeci">double SecantAmp</div><div class="ttdef"><b>Definition:</b> cg_user.h:137</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a7f897a3e4021337d3b88eee4408d1852"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a7f897a3e4021337d3b88eee4408d1852">dftfe::CGDescent::set_restart_fac</a></div><div class="ttdeci">void set_restart_fac(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:306</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a51661f00f4e95907f13916e983ee034c"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a51661f00f4e95907f13916e983ee034c">dftfe::CGDescent::set_eta2</a></div><div class="ttdeci">void set_eta2(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:275</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a55ea0e4b4ecf73571d92700ce03dbac8"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a55ea0e4b4ecf73571d92700ce03dbac8">dftfe::CGDescent::set_PertRule</a></div><div class="ttdeci">void set_PertRule(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:281</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af03050fb7309da012fe353c840800b9f"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af03050fb7309da012fe353c840800b9f">dftfe::CGDescent::set_qrule</a></div><div class="ttdeci">void set_qrule(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:347</div></div>
<div class="ttc" id="structcg__parameter__struct_html"><div class="ttname"><a href="structcg__parameter__struct.html">cg_parameter_struct</a></div><div class="ttdef"><b>Definition:</b> cg_user.h:29</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ac040a760211531184adb34dbb3819c1e"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ac040a760211531184adb34dbb3819c1e">dftfe::CGDescent::set_eps</a></div><div class="ttdeci">void set_eps(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:282</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html_a3448d983593e8e98ee594e4285f1f465"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html#a3448d983593e8e98ee594e4285f1f465">dftfe::nonlinearSolverProblem::value</a></div><div class="ttdeci">virtual void value(std::vector&lt; double &gt; &amp;functionValue)=0</div><div class="ttdoc">Compute function value (aka energy). </div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a728e0044e2a4e11ebd61f02150937238"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a728e0044e2a4e11ebd61f02150937238">dftfe::CGDescent::set_QuadSafe</a></div><div class="ttdeci">void set_QuadSafe(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:237</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a24f31e8bc19e53ccb860874ef5007520"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a24f31e8bc19e53ccb860874ef5007520">dftfe::CGDescent::set_Qdecay</a></div><div class="ttdeci">void set_Qdecay(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:278</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a1b2d69cf05f8a5a57bbbc008ac6ad6d6"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a1b2d69cf05f8a5a57bbbc008ac6ad6d6">dftfe::CGDescent::set_nan_rho</a></div><div class="ttdeci">void set_nan_rho(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:311</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ab6006e51c959d0382dade71e0d1e442b"><div class="ttname"><a href="structcg__parameter__struct.html#ab6006e51c959d0382dade71e0d1e442b">cg_parameter_struct::nan_decay</a></div><div class="ttdeci">double nan_decay</div><div class="ttdef"><b>Definition:</b> cg_user.h:163</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_aa00962dc65c94974ace1c1c183bf6845"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#aa00962dc65c94974ace1c1c183bf6845">dftfe::CGDescent::set_egrow</a></div><div class="ttdeci">void set_egrow(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:284</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ac848eae777ea4459e06b0e9ec22f7cdc"><div class="ttname"><a href="structcg__parameter__struct.html#ac848eae777ea4459e06b0e9ec22f7cdc">cg_parameter_struct::nan_rho</a></div><div class="ttdeci">double nan_rho</div><div class="ttdef"><b>Definition:</b> cg_user.h:160</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a754b6587ac1011fbe0175a7f6fb5a038"><div class="ttname"><a href="structcg__parameter__struct.html#a754b6587ac1011fbe0175a7f6fb5a038">cg_parameter_struct::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> cg_user.h:95</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a3fb940cd33373e61dce212967a4ea22d"><div class="ttname"><a href="structcg__parameter__struct.html#a3fb940cd33373e61dce212967a4ea22d">cg_parameter_struct::qrestart</a></div><div class="ttdeci">int qrestart</div><div class="ttdef"><b>Definition:</b> cg_user.h:188</div></div>
<div class="ttc" id="structcg__parameter__struct_html_adea3529cfefa3d398b4b70506cefc5ff"><div class="ttname"><a href="structcg__parameter__struct.html#adea3529cfefa3d398b4b70506cefc5ff">cg_parameter_struct::BetaLower</a></div><div class="ttdeci">double BetaLower</div><div class="ttdef"><b>Definition:</b> cg_user.h:183</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a8247b79cacf861b1c4b99112c6522072"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a8247b79cacf861b1c4b99112c6522072">dftfe::CGDescent::set_BetaLower</a></div><div class="ttdeci">void set_BetaLower(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:341</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_aad4a7a9085d45ba0546a16314374d5c1"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#aad4a7a9085d45ba0546a16314374d5c1">dftfe::CGDescent::set_nshrink</a></div><div class="ttdeci">void set_nshrink(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:302</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a13015a6586542e0e424438ef5b69e850"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a13015a6586542e0e424438ef5b69e850">dftfe::CGDescent::set_AWolfeFac</a></div><div class="ttdeci">void set_AWolfeFac(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:226</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a75e1bd8507008d8e75a50aa6fff68a41"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a75e1bd8507008d8e75a50aa6fff68a41">dftfe::CGDescent::set_ExpandSafe</a></div><div class="ttdeci">void set_ExpandSafe(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:292</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ac9ac81ce0bba3418c95fae8776cc3722"><div class="ttname"><a href="structcg__parameter__struct.html#ac9ac81ce0bba3418c95fae8776cc3722">cg_parameter_struct::nslow</a></div><div class="ttdeci">int nslow</div><div class="ttdef"><b>Definition:</b> cg_user.h:84</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a03ccc792fc2db609d6398862e5804702"><div class="ttname"><a href="structcg__parameter__struct.html#a03ccc792fc2db609d6398862e5804702">cg_parameter_struct::AdaptiveBeta</a></div><div class="ttdeci">int AdaptiveBeta</div><div class="ttdef"><b>Definition:</b> cg_user.h:182</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a60f7b89a452f93b1f2f6879d9b321cee"><div class="ttname"><a href="structcg__parameter__struct.html#a60f7b89a452f93b1f2f6879d9b321cee">cg_parameter_struct::ExpandSafe</a></div><div class="ttdeci">double ExpandSafe</div><div class="ttdef"><b>Definition:</b> cg_user.h:133</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a0ad0648daeac70bba385a580b05e86ec"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a0ad0648daeac70bba385a580b05e86ec">dftfe::CGDescent::set_theta</a></div><div class="ttdeci">void set_theta(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:343</div></div>
<div class="ttc" id="structcg__stats__struct_html_aef9497b92840dd2ba17e3ed8cbb6e58c"><div class="ttname"><a href="structcg__stats__struct.html#aef9497b92840dd2ba17e3ed8cbb6e58c">cg_stats_struct::ngrad</a></div><div class="ttdeci">INT ngrad</div><div class="ttdef"><b>Definition:</b> cg_user.h:200</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a3b8a7649dd0015d0b8113b3b5d00ecfa"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a3b8a7649dd0015d0b8113b3b5d00ecfa">dftfe::CGDescent::set_rho</a></div><div class="ttdeci">void set_rho(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:325</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html_a18cb9c702387c0fc0bea19dc358e331c"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html#a18cb9c702387c0fc0bea19dc358e331c">dftfe::nonlinearSolverProblem::update</a></div><div class="ttdeci">virtual void update(const std::vector&lt; double &gt; &amp;solution)=0</div><div class="ttdoc">Update solution. </div></div>
<div class="ttc" id="structcg__parameter__struct_html_a21479dee2c00bd065ce0832259cba8d3"><div class="ttname"><a href="structcg__parameter__struct.html#a21479dee2c00bd065ce0832259cba8d3">cg_parameter_struct::AWolfeFac</a></div><div class="ttdeci">double AWolfeFac</div><div class="ttdef"><b>Definition:</b> cg_user.h:76</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a7de73016a906231fe38bdfb4db28619b"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a7de73016a906231fe38bdfb4db28619b">dftfe::CGDescent::set_StopRule</a></div><div class="ttdeci">void set_StopRule(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:252</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_adc32f706c486b1b53dc2213e623ea05a"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#adc32f706c486b1b53dc2213e623ea05a">dftfe::CGDescent::set_step</a></div><div class="ttdeci">void set_step(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:245</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ab3975ce666eb2f1eb7a3d495c4faca2a"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ab3975ce666eb2f1eb7a3d495c4faca2a">dftfe::CGDescent::set_SubCheck</a></div><div class="ttdeci">void set_SubCheck(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:265</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a3bc3b427ee3108e684e7b3acc5868ca1"><div class="ttname"><a href="structcg__parameter__struct.html#a3bc3b427ee3108e684e7b3acc5868ca1">cg_parameter_struct::SmallCost</a></div><div class="ttdeci">double SmallCost</div><div class="ttdef"><b>Definition:</b> cg_user.h:116</div></div>
<div class="ttc" id="structcg__parameter__struct_html_abacd072d5fd0cd63a823b0d74e427ed5"><div class="ttname"><a href="structcg__parameter__struct.html#abacd072d5fd0cd63a823b0d74e427ed5">cg_parameter_struct::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdef"><b>Definition:</b> cg_user.h:170</div></div>
<div class="ttc" id="structcg__parameter__struct_html_abde2e610201c933502183d07843ddc16"><div class="ttname"><a href="structcg__parameter__struct.html#abde2e610201c933502183d07843ddc16">cg_parameter_struct::eta0</a></div><div class="ttdeci">double eta0</div><div class="ttdef"><b>Definition:</b> cg_user.h:62</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ad804798a24ec86b7ad552fe234edf7d7"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ad804798a24ec86b7ad552fe234edf7d7">dftfe::CGDescent::set_SmallCost</a></div><div class="ttdeci">void set_SmallCost(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:243</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a9b16464d7416931f59c4415cd25a9dfc"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a9b16464d7416931f59c4415cd25a9dfc">dftfe::CGDescent::set_nan_decay</a></div><div class="ttdeci">void set_nan_decay(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:313</div></div>
<div class="ttc" id="structcg__stats__struct_html_a27e17338fa5c415beba5f2d3e35a87a9"><div class="ttname"><a href="structcg__stats__struct.html#a27e17338fa5c415beba5f2d3e35a87a9">cg_stats_struct::gnorm</a></div><div class="ttdeci">double gnorm</div><div class="ttdef"><b>Definition:</b> cg_user.h:195</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ab173409cf2e2011a1b6cfc179a147e03"><div class="ttname"><a href="structcg__parameter__struct.html#ab173409cf2e2011a1b6cfc179a147e03">cg_parameter_struct::PertRule</a></div><div class="ttdeci">int PertRule</div><div class="ttdef"><b>Definition:</b> cg_user.h:94</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a5461fe48774acaf55df955fe43397b10"><div class="ttname"><a href="structcg__parameter__struct.html#a5461fe48774acaf55df955fe43397b10">cg_parameter_struct::nshrink</a></div><div class="ttdeci">int nshrink</div><div class="ttdef"><b>Definition:</b> cg_user.h:147</div></div>
<div class="ttc" id="cg__user_8h_html_abdbed41ac61843cd8b97d75281847a07"><div class="ttname"><a href="cg__user_8h.html#abdbed41ac61843cd8b97d75281847a07">cg_descent</a></div><div class="ttdeci">int cg_descent(double *x, INT n, cg_stats *Stats, cg_parameter *UParm, double grad_tol, double(*value)(double *, INT), void(*grad)(double *, double *, INT), double(*valgrad)(double *, double *, INT), double *Work, int(*user_test)(double, double *, double *, INT, void *), void *user_data)</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af29faebdbd8409c6ecbba5bfff6305b9"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af29faebdbd8409c6ecbba5bfff6305b9">dftfe::CGDescent::set_maxit</a></div><div class="ttdeci">void set_maxit(size_t val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:220</div></div>
<div class="ttc" id="cg__user_8h_html"><div class="ttname"><a href="cg__user_8h.html">cg_user.h</a></div></div>
<div class="ttc" id="structcg__parameter__struct_html_ad7e00ca78fcb4929bf51a33d6950b7e5"><div class="ttname"><a href="structcg__parameter__struct.html#ad7e00ca78fcb4929bf51a33d6950b7e5">cg_parameter_struct::theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> cg_user.h:184</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html">dftfe::CGDescent</a></div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:145</div></div>
<div class="ttc" id="structcg__stats__struct_html_a2b65a997649c8825769c40bdb591f13e"><div class="ttname"><a href="structcg__stats__struct.html#a2b65a997649c8825769c40bdb591f13e">cg_stats_struct::IterSub</a></div><div class="ttdeci">INT IterSub</div><div class="ttdef"><b>Definition:</b> cg_user.h:197</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a6accabee69ba898359fe6d71743562e3"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a6accabee69ba898359fe6d71743562e3">dftfe::CGDescent::get_gnorm</a></div><div class="ttdeci">double get_gnorm()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:359</div></div>
<div class="ttc" id="structcg__parameter__struct_html_aae96d10c9eeaa49f1a6e1c5caab16038"><div class="ttname"><a href="structcg__parameter__struct.html#aae96d10c9eeaa49f1a6e1c5caab16038">cg_parameter_struct::qeps</a></div><div class="ttdeci">double qeps</div><div class="ttdef"><b>Definition:</b> cg_user.h:185</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a953aa6c122d319feacd9ce4bd346c42c"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a953aa6c122d319feacd9ce4bd346c42c">dftfe::CGDescent::set_memory</a></div><div class="ttdeci">void set_memory(int memory)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:222</div></div>
<div class="ttc" id="structcg__parameter__struct_html_afc6f0a24db08ab66aa1c0cde1f86759f"><div class="ttname"><a href="structcg__parameter__struct.html#afc6f0a24db08ab66aa1c0cde1f86759f">cg_parameter_struct::nline</a></div><div class="ttdeci">int nline</div><div class="ttdef"><b>Definition:</b> cg_user.h:150</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a1e7f99cfafc0aca0e8d609ac8401547c"><div class="ttname"><a href="structcg__parameter__struct.html#a1e7f99cfafc0aca0e8d609ac8401547c">cg_parameter_struct::eta2</a></div><div class="ttdeci">double eta2</div><div class="ttdef"><b>Definition:</b> cg_user.h:70</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a9bec5b0a6ccedabb00dd50d713c08db5"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a9bec5b0a6ccedabb00dd50d713c08db5">dftfe::CGDescent::set_SecantAmp</a></div><div class="ttdeci">void set_SecantAmp(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:295</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a2c3108a46c4d15521ecc4649e835fc45"><div class="ttname"><a href="structcg__parameter__struct.html#a2c3108a46c4d15521ecc4649e835fc45">cg_parameter_struct::eta1</a></div><div class="ttdeci">double eta1</div><div class="ttdef"><b>Definition:</b> cg_user.h:66</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a19cefaf50c35ccf2e0c17a5f275ed7dd"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a19cefaf50c35ccf2e0c17a5f275ed7dd">dftfe::CGDescent::reset</a></div><div class="ttdeci">void reset(std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:207</div></div>
<div class="ttc" id="cg__user_8h_html_afeeffe52c8fd59db7c61cf8b02042dbf"><div class="ttname"><a href="cg__user_8h.html#afeeffe52c8fd59db7c61cf8b02042dbf">INT</a></div><div class="ttdeci">#define INT</div><div class="ttdef"><b>Definition:</b> cg_user.h:10</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af4655bd4ea36e58fc5bc97ca812af9d9"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af4655bd4ea36e58fc5bc97ca812af9d9">dftfe::CGDescent::set_lbfgs</a></div><div class="ttdeci">void set_lbfgs(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:230</div></div>
<div class="ttc" id="cg__user_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="cg__user_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> cg_user.h:23</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a15b1b5dbda522d04ff3413bbe783ae52"><div class="ttname"><a href="structcg__parameter__struct.html#a15b1b5dbda522d04ff3413bbe783ae52">cg_parameter_struct::LBFGS</a></div><div class="ttdeci">int LBFGS</div><div class="ttdef"><b>Definition:</b> cg_user.h:47</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a883c6324ee0b2004884782570cc8dcfa"><div class="ttname"><a href="structcg__parameter__struct.html#a883c6324ee0b2004884782570cc8dcfa">cg_parameter_struct::step</a></div><div class="ttdeci">double step</div><div class="ttdef"><b>Definition:</b> cg_user.h:124</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ae4467fd6ed85237f28a5ad5487082eda"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ae4467fd6ed85237f28a5ad5487082eda">dftfe::CGDescent::m_success</a></div><div class="ttdeci">bool m_success</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:152</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a28d35557ecd2989bcd460b3380074e78"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a28d35557ecd2989bcd460b3380074e78">dftfe::CGDescent::get_IterSub</a></div><div class="ttdeci">size_t get_IterSub()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:363</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a750538df9c26252a900231f0609d39af"><div class="ttname"><a href="structcg__parameter__struct.html#a750538df9c26252a900231f0609d39af">cg_parameter_struct::AWolfe</a></div><div class="ttdeci">int AWolfe</div><div class="ttdef"><b>Definition:</b> cg_user.h:75</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a93f05127b85f8e34f1f912bea71a0995"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a93f05127b85f8e34f1f912bea71a0995">dftfe::CGDescent::m_parm</a></div><div class="ttdeci">cg_parameter m_parm</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:147</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a1edc1987e841eab5a212770d865428de"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a1edc1987e841eab5a212770d865428de">dftfe::CGDescent::set_neps</a></div><div class="ttdeci">void set_neps(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:300</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a5e343430b14155edcbcc3b4139f14a9c"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a5e343430b14155edcbcc3b4139f14a9c">dftfe::CGDescent::set_tol</a></div><div class="ttdeci">void set_tol(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:389</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_aebfe50b05a79757c935ee2db0cf81b9e"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#aebfe50b05a79757c935ee2db0cf81b9e">dftfe::CGDescent::set_eta0</a></div><div class="ttdeci">void set_eta0(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:269</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a121a2ee034bf8075100753c300c7a7e8"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a121a2ee034bf8075100753c300c7a7e8">dftfe::CGDescent::set_feps</a></div><div class="ttdeci">void set_feps(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:308</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html_a57432a0cd4697e3af47a04923c481ef9"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html#a57432a0cd4697e3af47a04923c481ef9">dftfe::nonlinearSolverProblem::solution</a></div><div class="ttdeci">virtual void solution(std::vector&lt; double &gt; &amp;solution)=0</div><div class="ttdoc">Obtain current solution. </div></div>
<div class="ttc" id="structcg__parameter__struct_html_a044434b3876deef5d615e641d1909ac8"><div class="ttname"><a href="structcg__parameter__struct.html#a044434b3876deef5d615e641d1909ac8">cg_parameter_struct::maxit</a></div><div class="ttdeci">INT maxit</div><div class="ttdef"><b>Definition:</b> cg_user.h:127</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html_aef5a7d70f38f60fc254553b3cf42c12d"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html#aef5a7d70f38f60fc254553b3cf42c12d">dftfe::nonlinearSolverProblem::save</a></div><div class="ttdeci">virtual void save()=0</div><div class="ttdoc">create checkpoint for the current state of the problem i.e problem domain and solution. </div></div>
<div class="ttc" id="cg__user_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="cg__user_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> cg_user.h:15</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_aa8483749be0880731cc39f2df6286de8"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#aa8483749be0880731cc39f2df6286de8">dftfe::CGDescent::set_qrestart</a></div><div class="ttdeci">void set_qrestart(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:350</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a7d4f355c4a362d60a9f478759fbd111b"><div class="ttname"><a href="structcg__parameter__struct.html#a7d4f355c4a362d60a9f478759fbd111b">cg_parameter_struct::PrintFinal</a></div><div class="ttdeci">int PrintFinal</div><div class="ttdef"><b>Definition:</b> cg_user.h:36</div></div>
<div class="ttc" id="structcg__parameter__struct_html_abdf3050689c148c71152d9843c05c57d"><div class="ttname"><a href="structcg__parameter__struct.html#abdf3050689c148c71152d9843c05c57d">cg_parameter_struct::psi_lo</a></div><div class="ttdeci">double psi_lo</div><div class="ttdef"><b>Definition:</b> cg_user.h:174</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a26bf4250315c3ba5b375f12073a8c025"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a26bf4250315c3ba5b375f12073a8c025">dftfe::CGDescent::set_sigma</a></div><div class="ttdeci">void set_sigma(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:321</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a4b01dd0060c23e88e65ff9f947d94815"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a4b01dd0060c23e88e65ff9f947d94815">dftfe::CGDescent::set_debug</a></div><div class="ttdeci">void set_debug(bool val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:287</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a04559d5374ee519928cac52e4541cf17"><div class="ttname"><a href="structcg__parameter__struct.html#a04559d5374ee519928cac52e4541cf17">cg_parameter_struct::psi_hi</a></div><div class="ttdeci">double psi_hi</div><div class="ttdef"><b>Definition:</b> cg_user.h:176</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ad0d1f9a25cde2abcf0578e4951eb2ca9"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ad0d1f9a25cde2abcf0578e4951eb2ca9">dftfe::CGDescent::set_RhoGrow</a></div><div class="ttdeci">void set_RhoGrow(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:298</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a16ff87801c05817984c7bc962f2dfb8c"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a16ff87801c05817984c7bc962f2dfb8c">dftfe::CGDescent::set_psi1</a></div><div class="ttdeci">void set_psi1(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:334</div></div>
<div class="ttc" id="classdftfe_1_1nonlinear_solver_problem_html_ab4406839bedb92f39ac663738c699bf1"><div class="ttname"><a href="classdftfe_1_1nonlinear_solver_problem.html#ab4406839bedb92f39ac663738c699bf1">dftfe::nonlinearSolverProblem::gradient</a></div><div class="ttdeci">virtual void gradient(std::vector&lt; double &gt; &amp;gradient)=0</div><div class="ttdoc">Compute function gradient (aka forces). </div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af91efb8b8a735e9ea6ac95fd6d5f40e9"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af91efb8b8a735e9ea6ac95fd6d5f40e9">dftfe::CGDescent::m_nfev</a></div><div class="ttdeci">size_t m_nfev</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:151</div></div>
<div class="ttc" id="namespacedftfe_html"><div class="ttname"><a href="namespacedftfe.html">dftfe</a></div><div class="ttdef"><b>Definition:</b> upfToxml.cc:33</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_abfe9a0672ac0104d22691ceefb400706"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#abfe9a0672ac0104d22691ceefb400706">dftfe::CGDescent::get_nfev</a></div><div class="ttdeci">size_t get_nfev()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:371</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ab7b35ef5d14a46d8b02445f59ce46b8b"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ab7b35ef5d14a46d8b02445f59ce46b8b">dftfe::CGDescent::run</a></div><div class="ttdeci">bool run(nonlinearSolverProblem &amp;problem)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:178</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ab30c2653e8ff433d961c9e2b0f6cee37"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ab30c2653e8ff433d961c9e2b0f6cee37">dftfe::CGDescent::get_iter</a></div><div class="ttdeci">size_t get_iter()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:361</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a41b9ecc8b2fcfc08e6e665b9f8f5e260"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a41b9ecc8b2fcfc08e6e665b9f8f5e260">dftfe::CGDescent::set_qeps</a></div><div class="ttdeci">void set_qeps(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:345</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a5cca82761a6f656b40674469dc31d1bc"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a5cca82761a6f656b40674469dc31d1bc">dftfe::CGDescent::set_SubSkip</a></div><div class="ttdeci">void set_SubSkip(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:266</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a7dfba9a311a2ecf1f225187a15be7f32"><div class="ttname"><a href="structcg__parameter__struct.html#a7dfba9a311a2ecf1f225187a15be7f32">cg_parameter_struct::StopFac</a></div><div class="ttdeci">double StopFac</div><div class="ttdef"><b>Definition:</b> cg_user.h:90</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ab90a24ead034aaddf8e60033a34682c7"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ab90a24ead034aaddf8e60033a34682c7">dftfe::CGDescent::get_nfunc</a></div><div class="ttdeci">size_t get_nfunc()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:367</div></div>
<div class="ttc" id="structcg__parameter__struct_html_ab338c70505cb708603d217724ad34cd1"><div class="ttname"><a href="structcg__parameter__struct.html#ab338c70505cb708603d217724ad34cd1">cg_parameter_struct::neps</a></div><div class="ttdeci">int neps</div><div class="ttdef"><b>Definition:</b> cg_user.h:144</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a786f6873bf8943ac388d02250779e0dc"><div class="ttname"><a href="structcg__parameter__struct.html#a786f6873bf8943ac388d02250779e0dc">cg_parameter_struct::feps</a></div><div class="ttdeci">double feps</div><div class="ttdef"><b>Definition:</b> cg_user.h:156</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a11d8a579dd756137545c7f46458a4957"><div class="ttname"><a href="structcg__parameter__struct.html#a11d8a579dd756137545c7f46458a4957">cg_parameter_struct::SubCheck</a></div><div class="ttdeci">int SubCheck</div><div class="ttdef"><b>Definition:</b> cg_user.h:57</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_aa4fa7356ac4c740ed85a6ee6553f9c2b"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#aa4fa7356ac4c740ed85a6ee6553f9c2b">dftfe::CGDescent::~CGDescent</a></div><div class="ttdeci">virtual ~CGDescent()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:173</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ac904961bb4c64006c901d586ad1d8936"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ac904961bb4c64006c901d586ad1d8936">dftfe::CGDescent::get_NumSub</a></div><div class="ttdeci">size_t get_NumSub()</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:365</div></div>
<div class="ttc" id="structcg__parameter__struct_html_abe4a6b4501da5b5ca8e8e9b7fd8a61dd"><div class="ttname"><a href="structcg__parameter__struct.html#abe4a6b4501da5b5ca8e8e9b7fd8a61dd">cg_parameter_struct::restart_fac</a></div><div class="ttdeci">double restart_fac</div><div class="ttdef"><b>Definition:</b> cg_user.h:153</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a2dce061b51654acbc4ff64822575e551"><div class="ttname"><a href="structcg__parameter__struct.html#a2dce061b51654acbc4ff64822575e551">cg_parameter_struct::RhoGrow</a></div><div class="ttdeci">double RhoGrow</div><div class="ttdef"><b>Definition:</b> cg_user.h:141</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a4d949ee342bbb7775c1a3e0dc3165362"><div class="ttname"><a href="structcg__parameter__struct.html#a4d949ee342bbb7775c1a3e0dc3165362">cg_parameter_struct::sigma</a></div><div class="ttdeci">double sigma</div><div class="ttdef"><b>Definition:</b> cg_user.h:169</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_ac614d8c29bf570ec91c00dd5f5a4747f"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#ac614d8c29bf570ec91c00dd5f5a4747f">dftfe::CGDescent::set_PrintLevel</a></div><div class="ttdeci">void set_PrintLevel(int val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:218</div></div>
<div class="ttc" id="structcg__stats__struct_html_a46a535c2ac90380fee2d8e81d3e5024e"><div class="ttname"><a href="structcg__stats__struct.html#a46a535c2ac90380fee2d8e81d3e5024e">cg_stats_struct::nfunc</a></div><div class="ttdeci">INT nfunc</div><div class="ttdef"><b>Definition:</b> cg_user.h:199</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_af09e97d49b1189f7e83d7ce944ca96ae"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#af09e97d49b1189f7e83d7ce944ca96ae">dftfe::CGDescent::set_QuadCutOff</a></div><div class="ttdeci">void set_QuadCutOff(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:235</div></div>
<div class="ttc" id="structcg__stats__struct_html_a5f9255d9b5972d8a5b7733f92e71b141"><div class="ttname"><a href="structcg__stats__struct.html#a5f9255d9b5972d8a5b7733f92e71b141">cg_stats_struct::iter</a></div><div class="ttdeci">INT iter</div><div class="ttdef"><b>Definition:</b> cg_user.h:196</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a87da47146aa50dd92da19901970c29ad"><div class="ttname"><a href="structcg__parameter__struct.html#a87da47146aa50dd92da19901970c29ad">cg_parameter_struct::StopRule</a></div><div class="ttdeci">int StopRule</div><div class="ttdef"><b>Definition:</b> cg_user.h:89</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a68f188545179fa6dd85151bca9c8f57e"><div class="ttname"><a href="structcg__parameter__struct.html#a68f188545179fa6dd85151bca9c8f57e">cg_parameter_struct::psi2</a></div><div class="ttdeci">double psi2</div><div class="ttdef"><b>Definition:</b> cg_user.h:179</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a6b4dbcbd829363ab4604057ef67ecf4e"><div class="ttname"><a href="structcg__parameter__struct.html#a6b4dbcbd829363ab4604057ef67ecf4e">cg_parameter_struct::psi1</a></div><div class="ttdeci">double psi1</div><div class="ttdef"><b>Definition:</b> cg_user.h:177</div></div>
<div class="ttc" id="structcg__parameter__struct_html_a40d3a8afe8c4f5d3429417119de20731"><div class="ttname"><a href="structcg__parameter__struct.html#a40d3a8afe8c4f5d3429417119de20731">cg_parameter_struct::CubicCutOff</a></div><div class="ttdeci">double CubicCutOff</div><div class="ttdef"><b>Definition:</b> cg_user.h:113</div></div>
<div class="ttc" id="classdftfe_1_1_c_g_descent_html_a1041dc3618f13f5ebf0dc2a91736973f"><div class="ttname"><a href="classdftfe_1_1_c_g_descent.html#a1041dc3618f13f5ebf0dc2a91736973f">dftfe::CGDescent::set_gamma</a></div><div class="ttdeci">void set_gamma(double val)</div><div class="ttdef"><b>Definition:</b> cg_descent_wrapper.h:323</div></div>
<div class="ttc" id="nonlinear_solver_problem_8h_html"><div class="ttname"><a href="nonlinear_solver_problem_8h.html">nonlinearSolverProblem.h</a></div></div>
<div class="ttc" id="dft_utils_8h_html"><div class="ttname"><a href="dft_utils_8h.html">dftUtils.h</a></div></div>
<div class="ttc" id="structcg__parameter__struct_html_af561684af9bedf42854b6e03fcd35085"><div class="ttname"><a href="structcg__parameter__struct.html#af561684af9bedf42854b6e03fcd35085">cg_parameter_struct::QuadCutOff</a></div><div class="ttdeci">double QuadCutOff</div><div class="ttdef"><b>Definition:</b> cg_user.h:104</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
